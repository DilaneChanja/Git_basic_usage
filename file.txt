Basic initialization
some modification
Modification from Dilane
